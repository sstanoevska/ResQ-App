<PatientDashboardScreen>:
    MDFloatLayout:
        md_bg_color: 1, 1, 1, 1

        # Logo and Motto
        BoxLayout:
            orientation: 'vertical'
            spacing: "10dp"
            padding: "20dp"
            size_hint_y: None
            height: self.minimum_height
            pos_hint: {"center_x": 0.5, "top": 1}

            Image:
                source: "assets/logo1.png"
                size_hint: None, None
                size: "120dp", "120dp"
                allow_stretch: True
                keep_ratio: True
                pos_hint: {"center_x": 0.5}

        # Greeting
        MDBoxLayout:
            size_hint: None, None
            size: self.minimum_size
            pos_hint: {"x": 0.02, "top": 0.94}
            padding: "10dp"
            MDLabel:
                id: greeting_label
                text: "Welcome back, User!"
                font_size: "22sp"
                bold: True
                size_hint: None, None
                size: self.texture_size
                theme_text_color: "Custom"
                text_color: 0, 0, 0, 1
                halign: "left"
                valign: "middle"
                text_size: None, None

        # Log out button
        MDButton:
            style: "elevated"
            theme_bg_color: "Custom"
            md_bg_color: 0.15, 0.15, 0.15, 1
            size_hint: None, None
            size: "100dp", "40dp"
            pos_hint: {"right": 0.98, "top": 0.98}
            on_release: root.logout()

            MDButtonText:
                text: "Log out"
                theme_text_color: "Custom"
                text_color: 1, 1, 1, 1

        # Main layout
        MDBoxLayout:
            orientation: "horizontal"
            size_hint: 1, 0.75
            pos_hint: {"top": 0.83}
            padding: "10dp"

            # LEFT - Patient Info
            MDBoxLayout:
                orientation: "vertical"
                size_hint_x: 0.30
                padding: "10dp"
                spacing: "10dp"
                md_bg_color: 0.9, 0.3, 0.3, 1
                radius: [20, 20, 20, 20]

                ScrollView:
                    MDBoxLayout:
                        id: patient_info_box
                        orientation: "vertical"
                        size_hint_y: None
                        height: self.minimum_height
                        spacing: "8dp"

                MDButton:
                    style: "elevated"
                    theme_bg_color: "Custom"
                    md_bg_color: 0.8, 0.2, 0.2, 1
                    size_hint: None, None
                    size: "140dp", "40dp"
                    pos_hint: {"center_x": 0.5}
                    on_release: root.open_edit_profile_screen()
                    MDButtonText:
                        text: "Edit profile"
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1

            # CENTER - Panic Buttons and Alert
            # CENTER - Panic Buttons and Alert
            MDBoxLayout:
                orientation: "vertical"
                size_hint_x: 0.3
                spacing: "10dp"
                padding: "10dp", "80dp" # pushes everything downward
                pos_hint: {"center_y": 0.4}

                BoxLayout:
                    orientation: "horizontal"
                    spacing: "50dp"
                    size_hint_y: None
                    height: "80dp"
                    pos_hint: {"center_x": 0.5}

                    MDBoxLayout:
                        size_hint: None, None
                        size: "60dp", "60dp"
                        radius: [30]
                        md_bg_color: 1, 0, 0, 1  # red
                        padding: "5dp"
                        MDIconButton:
                            icon: "account-heart"
                            theme_text_color: "Custom"
                            text_color: 1, 1, 1, 1
                            size_hint: None, None
                            size: "50dp", "50dp"
                            pos_hint: {"center_x": 0.5, "center_y": 0.5}
                            on_release: root.send_alert("doctor")

                    MDBoxLayout:
                        size_hint: None, None
                        size: "60dp", "60dp"
                        radius: [30]
                        md_bg_color: 0, 0, 1, 1  # blue
                        padding: "5dp"
                        MDIconButton:
                            icon: "account-group"
                            theme_text_color: "Custom"
                            text_color: 1, 1, 1, 1
                            size_hint: None, None
                            size: "50dp", "50dp"
                            pos_hint: {"center_x": 0.5, "center_y": 0.5}
                            on_release: root.send_alert("others")

                BoxLayout:
                    spacing: "50dp"
                    size_hint_y: None
                    height: "20dp"
                    pos_hint: {"center_x": 0.47}
                    MDLabel:
                        text: "Doctor"
                        halign: "center"
                        theme_text_color: "Custom"
                        text_color: 0, 0, 0, 1
                    MDLabel:
                        text: "Others"
                        halign: "center"
                        theme_text_color: "Custom"
                        text_color: 0, 0, 0, 1

                MDBoxLayout:
                    id: custom_alert_box
                    orientation: "horizontal"
                    size_hint: None, None
                    size: "260dp", "30dp"  # ✅ fixed size
                    pos_hint: {"center_x": 0.5}
                    md_bg_color: 0, 0, 0, 1
                    padding: "10dp", "6dp"
                    radius: [10]
                    opacity: 0

                    MDLabel:
                        id: custom_alert_label
                        text: ""
                        font_size: "12sp"
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1
                        halign: "center"
                        valign: "middle"
                        size_hint: 1, 1
                        text_size: self.size  # ✅ allows horizontal wrapping




            # RIGHT - Emergency Contacts
            MDBoxLayout:
                orientation: "vertical"
                size_hint_x: 0.5
                padding: "20dp"
                spacing: "20dp"

                MDBoxLayout:
                    orientation: "horizontal"
                    size_hint_y: None
                    height: "60dp"
                    spacing: "20dp"

                    MDLabel:
                        text: "Emergency Contacts"
                        font_size: "18sp"
                        bold: True
                        halign: "left"
                        size_hint_x: 0.9
                        theme_text_color: "Custom"
                        text_color: 0, 0, 0, 1

                    MDIconButton:
                        icon: "plus"
                        style: "standard"
                        theme_icon_color: "Custom"
                        icon_color: 0, 0, 0, 1
                        on_release: root.manager.current = "add_contact"

                ScrollView:
                    MDBoxLayout:
                        id: contacts_list
                        orientation: "vertical"
                        size_hint_y: None
                        height: self.minimum_height
                        spacing: "10dp"

        # Appreciation Quote
        MDLabel:
            text: "\"The bravest thing you can do is ask for help — and it only takes one tap!\""
            font_size: "16sp"
            size_hint: None, None
            size: 600, 30
            pos_hint: {"center_x": 0.5, "y": 0.01}
            halign: "center"
            valign: "middle"
            text_size: self.size
            theme_text_color: "Custom"
            text_color: 0.2, 0.2, 0.2, 1
